本章先概括介绍运输层协议的特点，以及进程之间的通信以及端口等重要概念。然后讲述比较简单的 UDP 协议。其余的篇幅都是讨论较为复杂但非常重要的 TCP 协议[插图]和可靠传输的工作原理，包括停止等待协议和 ARQ 协议。在详细讲述 TCP 报文段的首部格式之后，讨论 TCP 的三个重要问题：滑动窗口、流量控制和拥塞控制机制。最后，介绍 TCP 的连接管理。
{: id="20201208154657-8p0ldyo"}

**运输层**是整个网络体系结构中的关键层次之一。一定要弄清以下一些重要概念：
{: id="20201208154657-3qh96gi"}

1. {: id="20201208154733-f5pa2ay"}运输层为相互通信的应用进程提供逻辑通信。
2. {: id="20201208154755-4yltakr"}端口和套接字的意义。
3. {: id="20201208154803-1fgo7x2"}无连接的 UDP 的特点。
4. {: id="20201208154811-4ub88o9"}面向连接的 TCP 的特点。
5. {: id="20201208154827-dh343zd"}在不可靠的网络上实现可靠传输的工作原理，停止等待协议和 ARQ 协议。
6. {: id="20201208154834-nef4qec"}TCP 的滑动窗口、流量控制、拥塞控制和连接管理。
{: id="20201208154717-ef9qoc7"}

# 5.1 运输层协议概述
{: id="20201208154839-rk04r33"}

### 5.1.1 进程之间的通信
{: id="20201208154858-1rjxl4w"}

**严格地讲，两个主机进行通信就是两个主机中的应用进程互相通信**。IP 协议虽然能把分组送到目的主机，但是这个分组还停留在主机的网络层而没有交付主机中的应用进程。从运输层的角度看，通信的真正端点并不是主机而是主机中的进程。也就是说，端到端的通信是应用进程之间的通信。在一个主机中经常有多个应用进程同时分别和另一个主机中的多个应用进程通信。
{: id="20201208154912-njjckf1"}

![51.png](assets/20201208161559-d3iyuu0-5-1.png)
{: id="20201208161428-h0wlv4z"}


{: id="20201208161615-u36s3q2"}

**从这里可以看出网络层和运输层有明显的区别。网络层是为主机之间提供逻辑通信，而运输层为应用进程之间提供端到端的逻辑通信**。
{: id="20201208161601-vp2uo10"}

根据应用程序的不同需求，运输层需要有两种不同的运输协议，即**面向连接的 TCP** 和 **无连接的 UDP**。
{: id="20201208161624-c1vknv0"}

![52.png](assets/20201208161804-6japjlj-5-2.png)
{: id="20201208161722-f9emws4"}

{: id="20201208161813-9v4l3sr"}

### 5.1.2 运输层的两个主要协议
{: id="20201208161814-y0g4pxp"}

TCP/IP 运输层的两个主要协议都是因特网的正式标准，即：
{: id="20201208161825-qms1ot0"}

1. {: id="20201208162314-9r5t0nc"}用户数据报协议 UDP (User Datagram Protocol)
2. {: id="20201208162322-pbiugo9"}传输控制协议 TCP (Transmission Control Protocol)
{: id="20201208162309-i12nccf"}

这两种协议在协议栈中的位置：
{: id="20201208162359-v68km13"}

![53.png](assets/20201208162349-lxb12fi-5-3.png)
{: id="20201208162329-330ebr0"}

{: id="20201208162421-ikq4wdn"}

按照 OSI 的术语，两个对等运输实体在通信时传送的数据单位叫作**运输协议数据单元 TPDU (Transport Protocol Data Unit)**。但在 TCP/IP 体系中，则根据所使用的协议是 TCP 或 UDP，分别称之为 **TCP 报文段**(segment) 或 **UDP 用户数据报**。
{: id="20201208162422-u6hi7hr"}

**使用 UDP 和 TCP 协议的各种应用和应用层协议**
{: id="20201208162432-ygowq89"}

![b51.png](assets/20201208162631-a6417qd-b5-1.png)
{: id="20201208162621-zoj6gm7"}

### 5.1.3 运输层的端口
{: id="20201208162827-r1qwlus"}

{: id="20201208162839-ynvsdyk"}
